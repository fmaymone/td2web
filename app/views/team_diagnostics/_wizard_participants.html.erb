<div class="row">
  <div class="col">
    <%= render partial: 'shared/form_errors', locals: { subject: @team_diagnostic } %>
  </div>
</div>

<div class="row">
  <div id="team_diagnostic--wizard--step-attention_items" class="col">
    <%= render partial: 'wizard_step_attention_items', locals: {service: @service} %>
  </div>
</div>


<div class="row">
  <div class="col">
      <div class="row">
        <div class="col">
          <% if policy(@team_diagnostic).modify_participants? %>
            <button class="btn btn-success" type="button" data-toggle="collapse" data-target="#add_participant_section" aria-expanded="false" aria-controls="add_participant_section"><%= 'Add Participant'.t %></button>
            <button class="btn btn-success" type="button" data-toggle="collapse" data-target="#import_section" aria-expanded="false" aria-controls="import_section"><%= 'Import'.t %></button>
            <%= link_to('View All', team_diagnostic_participants_path(team_diagnostic_id: @service.team_diagnostic.id), class: 'btn btn-sm btn-info') if @service.team_diagnostic.participants.any? && policy(Participant).index? %>
          <% end %>
        </p>
      </div>
    </div>
    <div class="row">
      <div class="col">
        <div class="collapse multi-collapse" id="add_participant_section">
          <%= render partial: 'participants/form', locals: {participant: @participant, remote: true} %>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col">
        <div class="collapse multi-collapse" id="import_section">
          <%= render partial: "participants/define_import" %>
        </div>
      </div>
    </div>
  </div>
</div>

<% participating = @service.team_diagnostic.participants.participating.order(last_name: :asc, first_name: :asc) %>

<% if participating.any? %>
  <div class="row">
    <div class="col">
      <table class="table shadow">
        <thead>
          <tr>
            <th><%= 'Status'.t %></th>
            <th><%= 'Name'.t %></th>
            <th><%= 'Contact'.t %></th>
            <th></th>
          </tr>
        </thead>
        <tbody>
          <%= render partial: 'participants/participant', collection: participating %>
        </tbody>
      </table>
    </div>
  </div>
<% else %>
  <p class="lead"><%= 'None'.t %></p>
<% end %>


<div class="row">
  <div class="col">
    <%= form_for(@service.team_diagnostic) do |form| %>
      <%= hidden_field_tag :step, @service.step %>
      <%= form.submit 'Continue'.t, class: 'btn btn-success' %>
    <% end if @service.next_step_accessible? && TeamDiagnosticPolicy.new(current_user, @service.team_diagnostic).modify_participants? %>
  </div>
</div>

